<?php

/*
 * Bryce Schmisseur and Hermes Mimini
 * Job Match Application
 * LoginRegistrationController.php
 *
 */

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Routing\Controller;
use App\business\UserBusinessService; 

class AdminController extends Controller
{
    private $service;
    
    function __construct()
    {
        $this->service = new UserBusinessService();
    }
    
    public function adminPage()
    {
        $data = ['userList' => $this->service->viewAll()];
        return view('admin')->with($data); 
    }
    
    public function deleteUser(Request $request)
    {
        $userId = $request->input('userId');
        
        $this->service->delete($userId);
        
        $data = ['userList' => $this->service->viewAll()];
        return view('admin')->with($data); 
    }
    
    public function suspendUser(Request $request)
    {
        $userId = $request->input('userId');
        
        $currentUser = $this->service->viewById($userId);
        
        if($currentUser->isActive() == 1)
        {
            $currentUser->setActive(0);
        }
        
        else
        {
            $currentUser->setActive(1);
        }
        
        $this->service->update($currentUser);
        
        $data = ['userList' => $this->service->viewAll()];
        return view('admin')->with($data); 
    }
}
